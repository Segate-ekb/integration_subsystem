////////////////////////////////////////////////////////////////////////////////
// конс_ПодключаемаяКонсольПовтИсп: Кэширование данных для редактора
////////////////////////////////////////////////////////////////////////////////
// Модуль с повторным использованием значений в течение запроса
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Получает данные макета src с исходниками редактора.
// Результат кэшируется в течение запроса.
// 
// Возвращаемое значение:
//   ДвоичныеДанные, Неопределено - данные макета или Неопределено
//
Функция ПолучитьДанныеМакетаИсходников() Экспорт
	
	Попытка
		Макет = ПолучитьОбщийМакет("конс_КонсольКода");
		Возврат Макет;
	Исключение
		Возврат Неопределено;
	КонецПопытки;
	
КонецФункции

// Получает хеш данных макета с исходниками для контроля версий.
// Результат кэшируется в течение запроса.
// 
// Возвращаемое значение:
//   Строка - хеш данных макета или пустая строка
//
Функция ПолучитьХешМакетаИсходников() Экспорт
	
	ДанныеМакета = ПолучитьДанныеМакетаИсходников();
	Если ДанныеМакета = Неопределено Тогда
		Возврат "";
	КонецЕсли;
	
	Возврат конс_ПодключаемаяКонсольСервер.ВычислитьХешДанных(ДанныеМакета);
	
КонецФункции

// Получает коллекцию общих модулей.
// Результат кэшируется в течение запроса.
// 
// Возвращаемое значение:
//   Массив - массив структур с описанием модулей
//
Функция ПолучитьКоллекциюОбщихМодулей() Экспорт
	
	Возврат конс_ПодключаемаяКонсольСервер.ПолучитьКоллекциюОбщихМодулей();
	
КонецФункции

// Получает список метаданных для автодополнения.
// Результат кэшируется в течение запроса.
// 
// Возвращаемое значение:
//   Структура
//
Функция ПолучитьМетаданныеДляРедактора() Экспорт
	
	Возврат конс_ПодключаемаяКонсольСервер.ПолучитьМетаданныеДляРедактора();
	
КонецФункции

// Проверяет, имеет ли объект метаданных стандартные реквизиты.
// 
// Параметры:
//   ПолноеИмяОбъекта - Строка - полное имя объекта метаданных
//
// Возвращаемое значение:
//   Булево
//
Функция ОбъектМетаданныхИмеетСтандартныеРеквизиты(ПолноеИмяОбъекта) Экспорт
	
	Возврат СтрНайти(ПолноеИмяОбъекта, "Справочник") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "Catalog") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "Документ") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "Document") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "ПланВидовХарактеристик") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "ChartOfCharacteristicTypes") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "ПланСчетов") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "ChartOfAccounts") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "ПланВидовРасчета") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "ChartOfCalculationTypes") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "БизнесПроцесс") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "BusinessProcess") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "Задача") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "Task") = 1;
	
КонецФункции

// Проверяет, имеет ли объект метаданных табличные части.
// 
// Параметры:
//   ПолноеИмяОбъекта - Строка
//
// Возвращаемое значение:
//   Булево
//
Функция ОбъектМетаданныхИмеетТабличныеЧасти(ПолноеИмяОбъекта) Экспорт
	
	Возврат ОбъектМетаданныхИмеетСтандартныеРеквизиты(ПолноеИмяОбъекта)
		Или СтрНайти(ПолноеИмяОбъекта, "РегистрСведений") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "InformationRegister") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "РегистрНакопления") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "AccumulationRegister") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "РегистрБухгалтерии") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "AccountingRegister") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "РегистрРасчета") = 1
		Или СтрНайти(ПолноеИмяОбъекта, "CalculationRegister") = 1;
	
КонецФункции

#КонецОбласти
