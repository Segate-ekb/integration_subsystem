---
outline: deep
---

# API Reference

Справочник по объектам метаданных подсистемы интеграции.

## Структура подсистемы

```
Подсистема интеграции
├── Справочники (конфигурация)
│   ├── инт_ПотокиДанных
│   ├── инт_ПодписчикиHTTP
│   ├── инт_ПодписчикиRabbitMQ
│   ├── инт_ПодписчикиKafka
│   ├── инт_ПодписчикиJRPC
│   ├── инт_ПодписчикиПодсистемаИнтеграции
│   ├── инт_Схемы
│   └── инт_Эндпоинты
│
├── Регистры сведений (данные)
│   ├── инт_ОчередьИсходящихСообщений
│   ├── инт_ОчередьВходящихСообщений
│   ├── инт_ОчередьОтправкиИсходящихСообщений
│   ├── инт_ТекущийСтатусИсходящихСообщений
│   ├── инт_ТекущийСтатусВходящихСообщений
│   ├── инт_ТекущийСтатусРассылкиСообщений
│   ├── инт_ИсторияСтатусовИсходящихСообщений
│   ├── инт_ИсторияСтатусовВходящихСообщений
│   ├── инт_ИсторияСтатусовРассылкиСообщений
│   ├── инт_МенеджерПотоковФормированияСообщений
│   ├── инт_МенеджерПотоковОтправкиСообщений
│   ├── инт_АктивныеКонсьюмеры
│   ├── инт_СтатистикаОбработкиСообщений
│   ├── инт_СообщенияКУдалению
│   ├── инт_ХешиОбъектов
│   ├── инт_ИдентификаторыВнешнихСистем
│   └── инт_КэшированиеСхемOpenApi
│
├── Общие модули (логика)
│   ├── инт_ФормированиеИсходящихСообщений
│   ├── инт_ОтправкаИсходящихСообщений
│   ├── инт_ОбработкаВходящихПотоков
│   ├── инт_МенеджерВходящихПотоков
│   ├── инт_КонсьюмерОчередей
│   ├── инт_ВалидаторПакетов
│   ├── инт_КоннекторHTTP
│   ├── инт_ПодписчикиОбщий
│   ├── инт_РаботаСКафка
│   ├── инт_РаботаСБезопаснымХранилищем
│   ├── инт_ЭндпоинтыКлиент
│   └── инт_ЭндпоинтыКлиентСервер
│
├── Перечисления
│   ├── инт_НаправлениеПотокаДанных
│   ├── инт_СтатусыИсходящихСообщений
│   ├── инт_СтатусыВходящихСообщений
│   ├── инт_СтатусыРассылкиИсходящихСообщений
│   ├── инт_ТипыПодписчиков
│   ├── инт_ТипыАвторизации
│   ├── инт_СпособыПередачиПараметровПоHTTP
│   └── инт_ТипыСжатияKafka
│
├── Регламентные задания
│   ├── инт_МенеджерПотоковФормированияИсходящихСообщений
│   ├── инт_МенеджерПотоковРассылкиСообщений
│   ├── инт_МенеджерВходящихПотоков
│   ├── инт_ОбработкаВходящейОчереди
│   ├── инт_ОчисткаУстаревшихСообщений
│   ├── инт_ОчисткаСтатистикиОбработкиСообщений
│   ├── пэмВыполнитьРасчетМетрик
│   └── пэмРегламентныеОперации
│
└── HTTP-сервисы
    └── prometheus (экспорт метрик)
```

## Ключевые объекты

### Справочники

| Объект | Описание |
|--------|----------|
| `инт_ПотокиДанных` | Потоки данных с обработчиками |
| `инт_ПодписчикиHTTP` | HTTP/HTTPS подписчики |
| `инт_ПодписчикиKafka` | Подписчики Apache Kafka |
| `инт_ПодписчикиJRPC` | Подписчики JSON-RPC 2.0 |
| `инт_ПодписчикиПодсистемаИнтеграции` | Межбазовые подписчики |
| `инт_ПодписчикиRabbitMQ` | Подписчики RabbitMQ |
| `инт_Схемы` | OpenAPI-схемы для валидации |
| `инт_Эндпоинты` | Настройки подключения (URL, авторизация) |

### Регистры сведений

| Объект | Описание |
|--------|----------|
| `инт_ОчередьИсходящихСообщений` | Очередь исходящих сообщений |
| `инт_ОчередьВходящихСообщений` | Очередь входящих сообщений |
| `инт_ТекущийСтатусИсходящихСообщений` | Текущие статусы |

### Общие модули

| Модуль | Описание |
|--------|----------|
| `инт_ВалидаторПакетов` | Валидация по OpenAPI |
| `инт_ФормированиеИсходящихСообщений` | Формирование сообщений |
| `инт_ОтправкаИсходящихСообщений` | Отправка сообщений |

## Быстрые ссылки

### Регистрация сообщения

```bsl
РегистрыСведений.инт_ОчередьИсходящихСообщений.ЗарегистрироватьСообщение(
    ИсходныеДанные,
    ПотокДанных,
    РегистрироватьДубль
)
```

### Валидация

```bsl
МассивОшибок = инт_ВалидаторПакетов.Валидировать(
    МодельДанных,
    ИмяСхемы,
    ТекстСхемыJSON
)
```

### Получение потока по коду

```bsl
ПотокДанных = Справочники.инт_ПотокиДанных.ПолучитьПотокПоИдентификатору(
    "ORDER_EXPORT",
    НаправлениеПотока
)
```

## Перечисления

### инт_НаправлениеПотокаДанных

| Значение | Описание |
|----------|----------|
| `Исходящий` | Отправка данных из 1С |
| `Входящий` | Приём данных в 1С |

### инт_СтатусыИсходящихСообщений

| Значение | Описание |
|----------|----------|
| `Новый` | Зарегистрировано |
| `ФормированиеСообщения` | Формируется |
| `ОшибкаФормирования` | Ошибка обработчика |
| `ГотовоКОтправке` | Сформировано |
| `ПомещеноВОчередьОтправки` | В очереди рассылки |
| `Отправлено` | Успешно отправлено |
| `ОшибкаОтправки` | Ошибка отправки |

### инт_ТипыАвторизации

| Значение | Описание |
|----------|----------|
| `Анонимный` | Без авторизации |
| `Basic` | HTTP Basic Auth |
| `Bearer` | Bearer Token |
| `Digest` | HTTP Digest Auth |
| `Tls` | Клиентский TLS-сертификат (mTLS) |
| `ApiKey` | API Key в HTTP-заголовке |

### инт_ТипыСжатияKafka

| Значение | Описание |
|----------|----------|
| `БезСжатия` | Без сжатия (none) |
| `Gzip` | Gzip |
| `Snappy` | Google Snappy |
| `Lz4` | LZ4 |
| `Zstd` | Zstandard |

## Типы данных

### ОпределяемыйТип.инт_Подписчик

Полиморфный тип для ссылки на любой справочник подписчика. Используется в табличной части `ПодписчикиПотока` справочника `инт_ПотокиДанных`.

```
ОпределяемыйТип.инт_Подписчик
  ├── СправочникСсылка.инт_ПодписчикиHTTP
  ├── СправочникСсылка.инт_ПодписчикиJRPC
  ├── СправочникСсылка.инт_ПодписчикиПодсистемаИнтеграции
  ├── СправочникСсылка.инт_ПодписчикиKafka
  └── СправочникСсылка.инт_ПодписчикиRabbitMQ
```

Диспетчеризация вызовов реализована в модуле `инт_ПодписчикиОбщий`.

### ОпределяемыйТип.инт_ИсходныеДанные

Типы, которые могут быть исходными данными для сообщений:

```
Тип = ДокументСсылка.*
    | СправочникСсылка.*
    | ФиксированнаяСтруктура
```

Настраивается в конфигураторе для конкретной конфигурации.

## Примеры использования

### Полный цикл отправки

```bsl
// 1. Регистрация
ИдСообщения = РегистрыСведений.инт_ОчередьИсходящихСообщений
    .ЗарегистрироватьСообщение(ДокументСсылка, ПотокДанных);

// 2. Формирование (обычно автоматически)
РегистрыСведений.инт_ОчередьИсходящихСообщений
    .СформироватьСообщениеПоИдентификатору(ИдСообщения);

// 3. Регистрация к отправке
РегистрыСведений.инт_ОчередьИсходящихСообщений
    .ЗарегистрироватьСообщениеКОтправке(ИдСообщения);

// 4. Отправка (обычно автоматически через регл. задание)
```

### Получение данных сообщения

```bsl
ДанныеСообщения = РегистрыСведений.инт_ОчередьИсходящихСообщений
    .ПолучитьДанныеОчередиПоИдентификатору(
        ИдентификаторСообщения,
        "ИсходныеДанные, ПотокДанных, СформированноеСообщение"
    );
```

### Удаление сообщения

```bsl
РегистрыСведений.инт_ОчередьИсходящихСообщений
    .УдалитьСообщениеИзОчередиПоИдентификатору(ИдентификаторСообщения);
```

## См. также

- [Концепции: Очереди сообщений](/concepts/message-queues)
- [Концепции: Валидация](/concepts/validation)
- [Руководство: Создание потока](/guide/create-flow)
