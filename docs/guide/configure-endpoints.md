---
outline: deep
---

# Настройка эндпоинтов

Пошаговое руководство по настройке подключений в справочнике `инт_Эндпоинты`.

## Что такое эндпоинт

Эндпоинт — это именованный набор параметров подключения: базовый URL и учётные данные. Все подписчики ссылаются на эндпоинт, поэтому смена среды (dev → test → prod) выполняется в одном месте.

## Создание эндпоинта

Откройте справочник `инт_Эндпоинты` и создайте новый элемент.

### Базовые параметры

| Поле | Описание | Пример |
|------|----------|--------|
| **Наименование** | Понятное имя для выбора в подписчике | `WMS Production` |
| **Адрес ресурса** | Базовый URL без завершающего `/` | `https://wms.example.com/api` |
| **Проверять SSL** | Проверка TLS-сертификата сервера | ✅ (рекомендуется) |
| **Таймаут соединения** | Секунды до разрыва соединения | `30` |

::: tip Структура URL
Адрес ресурса — это базовый адрес. Конечный путь (`/v1/orders`) задаётся в самом подписчике. Разделение позволяет использовать один эндпоинт для нескольких подписчиков.
:::

### Выбор типа авторизации

Выберите тип в поле **«Тип авторизации»** — форма автоматически покажет нужные поля.

---

## Настройка по типу авторизации

### Анонимный

Поля авторизации не заполняются. Используйте для:
- Публичных API без авторизации
- Сервисов во внутренней сети с другим механизмом безопасности

### Basic Auth

```
Тип авторизации: Basic
Пользователь:   api_user
Пароль:         ●●●●●●●●
```

Данные передаются в заголовке `Authorization: Basic <base64(user:password)>`.

### Bearer Token

```
Тип авторизации: Bearer
Токен:           eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

Данные передаются в заголовке `Authorization: Bearer <token>`.

::: tip Ротация токенов
Если токен обновляется автоматически (OAuth2 client credentials), настройте его обновление через `инт_РаботаСБезопаснымХранилищем` или добавьте логику в обработчик пост-процессинга подписчика.
:::

### Digest Auth

```
Тип авторизации: Digest
Пользователь:   api_user
Пароль:         ●●●●●●●●
```

HTTP Digest используется, когда Basic Auth запрещён политикой безопасности сервера. Механизм challenge-response — пароль не передаётся в открытом виде.

### TLS (mTLS — клиентский сертификат)

Двусторонняя аутентификация: сервер проверяет сертификат клиента.

#### Вариант 1: Файл сертификата

```
Тип авторизации:  Tls
Источник:         Файл
Путь к файлу:     C:\certs\client.pfx
Пароль:           ●●●●●●●●
```

#### Вариант 2: Хранилище Windows

```
Тип авторизации:  Tls
Источник:         Хранилище Windows
Отпечаток:        ABC123DEF456789012345678901234567890AB
```

Отпечаток можно посмотреть в оснастке `certmgr.msc` → Личные → Сертификаты → двойной клик → вкладка «Состав» → поле «Отпечаток».

### ApiKey

```
Тип авторизации:  ApiKey
Имя заголовка:    X-API-Key
Значение:         sk-1234567890abcdef...
```

Ключ передаётся в указанном HTTP-заголовке. Имя заголовка зависит от API-провайдера (`X-API-Key`, `X-Auth-Token`, `Api-Key` и т.д.).

---

## Проверка подключения

После заполнения параметров нажмите кнопку **«Проверить подключение»**:

- ✅ Зелёный индикатор — сервер достижим и авторизация прошла
- ❌ Красный — ошибка. Сообщение об ошибке содержит HTTP-код или системную ошибку сети

::: warning Параметры запроса при проверке
Для HTTP-эндпоинтов проверяется только базовый URL (`GET /`). Если сервер возвращает 404, но причина в том, что корневой путь не существует,  — это нормально. Соединение установлено и авторизация работает.
:::

---

## Управление несколькими средами

Рекомендуемое именование:

| Среда | Наименование эндпоинта | Адрес |
|-------|------------------------|-------|
| Разработка | `WMS API (Dev)` | `http://wms-dev.internal:8080` |
| Тест | `WMS API (Test)` | `https://wms-test.example.com/api` |
| Продуктив | `WMS API (Prod)` | `https://wms.example.com/api` |

В подписчике укажите нужный эндпоинт. При переходе на другую среду достаточно изменить ссылку в **одном** подписчике.

---

## Следующие шаги

- [Настройка подписчиков](/guide/configure-subscribers) — привязка эндпоинтов к подписчикам
- [Управление эндпоинтами (концепции)](/concepts/endpoint-management) — типы авторизации, безопасное хранение
- [Подписчики](/concepts/subscribers) — обзор всех типов подписчиков
